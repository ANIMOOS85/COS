{% extends 'store/base.html' %}
{% load static %}

{% block content %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;700&display=swap" rel="stylesheet">

<style>
  /* ğŸŒŒ Aurora Night Background Ø¨Ø±Ø§ÛŒ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ */
  body {
    font-family: 'Vazirmatn', sans-serif;
    min-height: 100vh;
    position: relative;
    overflow-x: hidden;
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    background-size: 400% 400%;
    animation: aurora 18s ease infinite;
    color: #fff;
  }

  @keyframes aurora {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  body::before {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at 25% 30%, rgba(255,0,150,0.25), transparent 60%),
                radial-gradient(circle at 80% 70%, rgba(0,200,255,0.2), transparent 70%);
    mix-blend-mode: screen;
    pointer-events: none;
    animation: glow 10s ease-in-out infinite alternate;
  }

  @keyframes glow {
    0% { transform: translateY(0px); opacity: 0.8; }
    100% { transform: translateY(30px); opacity: 1; }
  }

  /* Ú©Ø§Ø±Øª Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´ÛŒØ´Ù‡â€ŒØ§ÛŒ */
  .cart-container {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(15px);
    border-radius: 20px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.2);
    padding: 40px 25px;
    transition: all 0.3s ease;
  }

  .cart-container:hover {
    box-shadow: 0 12px 40px rgba(0,0,0,0.25);
  }

  h2 {
    font-weight: 700;
    color: #00bfff;
  }

  table {
    border-radius: 15px;
    overflow: hidden;
    color: #fff;
  }

  thead {
    background-color: rgba(255,255,255,0.1);
  }

  tbody tr:hover {
    background-color: rgba(255,255,255,0.05);
  }

  .table-secondary {
    background-color: rgba(255,255,255,0.2) !important;
    font-weight: bold;
  }

  .product-img {
    width: 70px;
    height: 70px;
    object-fit: cover;
    border-radius: 10px;
  }

  .empty-cart {
    background-color: rgba(255,255,255,0.2);
    color: #fff;
    border-radius: 10px;
    padding: 15px 25px;
    display: inline-block;
  }

  .btn-checkout {
    background: linear-gradient(135deg, #00b09b, #96c93d);
    color: #fff;
    border-radius: 10px;
    padding: 10px 25px;
    transition: 0.3s;
  }

  .btn-checkout:hover {
    background: linear-gradient(135deg, #96c93d, #00b09b);
  }

  .btn-remove {
    background: none;
    border: none;
    color: #ff6b6b;
    font-size: 1.3rem;
    transition: color 0.2s ease;
  }

  .btn-remove:hover {
    color: #ff3b3b;
  }

  @media (max-width: 768px) {
    .product-img { width: 50px; height: 50px; }
    .cart-container { padding: 25px 15px; }
  }
</style>

<div class="container my-5">
  <div class="cart-container">
    <h2 class="mb-4 text-center"><i class="bi bi-cart3"></i> Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§</h2>

    {% if cart and cart.items.all %}
      <div class="table-responsive">
        <table class="table align-middle text-center">
          <thead>
            <tr>
              <th>Ù…Ø­ØµÙˆÙ„</th>
              <th>Ù†Ø§Ù…</th>
              <th>ØªØ¹Ø¯Ø§Ø¯</th>
              <th>Ù‚ÛŒÙ…Øª ÙˆØ§Ø­Ø¯</th>
              <th>Ø¬Ù…Ø¹</th>
              <th>Ø­Ø°Ù</th>
            </tr>
          </thead>
          <tbody>
            {% for item in cart.items.all %}
            <tr>
              <td>
                {% if item.product.image %}
                  <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}" class="product-img">
                {% else %}
                  <i class="bi bi-image" style="font-size:2rem; color:#adb5bd;"></i>
                {% endif %}
              </td>
              <td>{{ item.product.name }}</td>
              <td>{{ item.quantity }}</td>
              <td>{{ item.product.price }} ØªÙˆÙ…Ø§Ù†</td>
              <td>{{ item.total }} ØªÙˆÙ…Ø§Ù†</td>
              <td>
                <form action="{% url 'store:remove_from_cart' item.id %}" method="post">
                  {% csrf_token %}
                  <button type="submit" class="btn-remove" title="Ø­Ø°Ù Ù…Ø­ØµÙˆÙ„">
                    <i class="bi bi-trash"></i>
                  </button>
                </form>
              </td>
            </tr>
            {% endfor %}
            <tr class="table-secondary">
              <td colspan="4" class="text-end">Ø¬Ù…Ø¹ Ú©Ù„:</td>
              <td colspan="2"><strong>{{ cart.total_price }} ØªÙˆÙ…Ø§Ù†</strong></td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="text-end mt-4">
        <a href="#" class="btn btn-checkout">
          <i class="bi bi-credit-card"></i> ØªØ³ÙˆÛŒÙ‡ Ø­Ø³Ø§Ø¨
        </a>
      </div>

    {% else %}
      <div class="text-center mt-5">
        <p class="empty-cart"><i class="bi bi-emoji-frown"></i> Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª</p>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
